<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ‰ CNSHç¼–è¾‘å™¨ v2.0 - ä¸“ä¸šä¸­æ–‡ç¼–ç¨‹ç¯å¢ƒ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/dracula.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/clike/clike.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', 'PingFang SC', sans-serif;
            height: 100vh;
            overflow: hidden;
            background: #1e1e1e;
        }
        
        /* é¡¶éƒ¨å·¥å…·æ  */
        .toolbar {
            background: linear-gradient(135deg, #E63946 0%, #c41e29 100%);
            color: white;
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        .toolbar-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo {
            font-size: 24px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo-icon {
            font-size: 32px;
            animation: glow 2s ease-in-out infinite;
        }
        
        @keyframes glow {
            0%, 100% { text-shadow: 0 0 10px #FFD700; }
            50% { text-shadow: 0 0 20px #FFD700, 0 0 30px #FFD700; }
        }
        
        .toolbar-buttons {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 6px;
            font-family: inherit;
        }
        
        .btn-gold {
            background: #FFD700;
            color: #000;
        }
        
        .btn-gold:hover {
            background: #ffed4e;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.4);
        }
        
        .btn-green {
            background: #06D6A0;
            color: white;
        }
        
        .btn-green:hover {
            background: #04c794;
            transform: translateY(-2px);
        }
        
        .btn-white {
            background: white;
            color: #333;
        }
        
        .btn-white:hover {
            background: #f0f0f0;
        }
        
        /* ä¸»å®¹å™¨ */
        .container {
            display: flex;
            height: calc(100vh - 106px);
        }
        
        /* ä¾§è¾¹æ  */
        .sidebar {
            width: 280px;
            background: #252526;
            border-right: 1px solid #3c3c3c;
            display: flex;
            flex-direction: column;
        }
        
        .sidebar-header {
            padding: 15px;
            background: #2d2d30;
            color: #FFD700;
            font-weight: bold;
            border-bottom: 2px solid #FFD700;
        }
        
        .template-list {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
        }
        
        .template-item {
            padding: 12px 15px;
            margin: 5px 0;
            background: #2d2d30;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            color: #cccccc;
            border-left: 3px solid transparent;
        }
        
        .template-item:hover {
            background: #37373d;
            border-left-color: #FFD700;
            transform: translateX(5px);
            color: white;
        }
        
        .template-title {
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .template-desc {
            font-size: 12px;
            opacity: 0.7;
        }
        
        /* ç¼–è¾‘å™¨åŒºåŸŸ */
        .editor-area {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .editor-tabs {
            background: #2d2d30;
            display: flex;
            border-bottom: 1px solid #3c3c3c;
        }
        
        .editor-tab {
            padding: 10px 20px;
            color: #cccccc;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
        }
        
        .editor-tab.active {
            color: #FFD700;
            border-bottom-color: #FFD700;
            background: #1e1e1e;
        }
        
        .editor-tab:hover:not(.active) {
            background: #37373d;
        }
        
        .code-mirror-wrapper {
            flex: 1;
            overflow: hidden;
        }
        
        .CodeMirror {
            height: 100%;
            font-size: 14px;
            line-height: 1.6;
        }
        
        /* è¾“å‡ºåŒºåŸŸ */
        .output-area {
            width: 450px;
            background: #252526;
            border-left: 1px solid #3c3c3c;
            display: flex;
            flex-direction: column;
        }
        
        .output-tabs {
            display: flex;
            background: #2d2d30;
            border-bottom: 1px solid #3c3c3c;
        }
        
        .output-tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            cursor: pointer;
            color: #cccccc;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
        }
        
        .output-tab.active {
            color: #FFD700;
            border-bottom-color: #FFD700;
            background: #1e1e1e;
        }
        
        .output-tab:hover:not(.active) {
            background: #37373d;
        }
        
        .output-content {
            flex: 1;
            overflow: auto;
            display: none;
            padding: 15px;
            font-family: 'Consolas', monospace;
            font-size: 13px;
            line-height: 1.6;
            color: #d4d4d4;
        }
        
        .output-content.active {
            display: block;
        }
        
        .log-item {
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 4px;
            border-left: 4px solid;
        }
        
        .log-success {
            background: rgba(6, 214, 160, 0.1);
            border-left-color: #06D6A0;
            color: #06D6A0;
        }
        
        .log-error {
            background: rgba(239, 71, 111, 0.1);
            border-left-color: #EF476F;
            color: #EF476F;
        }
        
        .log-info {
            background: rgba(26, 115, 232, 0.1);
            border-left-color: #1a73e8;
            color: #8ab4f8;
        }
        
        .log-warning {
            background: rgba(255, 182, 39, 0.1);
            border-left-color: #FFB627;
            color: #FFB627;
        }
        
        .c-code-display {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 15px;
            font-family: 'Consolas', monospace;
            font-size: 13px;
            line-height: 1.6;
            white-space: pre;
            overflow: auto;
        }
        
        /* çŠ¶æ€æ  */
        .statusbar {
            background: #007acc;
            color: white;
            padding: 6px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #06D6A0;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }
        
        /* é€šçŸ¥ */
        .notification {
            position: fixed;
            top: 70px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            color: white;
            font-weight: 500;
            z-index: 9999;
            animation: slideIn 0.3s;
            max-width: 400px;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .notification.success { background: #06D6A0; }
        .notification.error { background: #EF476F; }
        .notification.warning { background: #FFB627; color: #333; }
        
        /* æ»šåŠ¨æ¡ç¾åŒ– */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: #1e1e1e;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #424242;
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #4e4e4e;
        }
    </style>
</head>
<body>
    <!-- å·¥å…·æ  -->
    <div class="toolbar">
        <div class="toolbar-left">
            <div class="logo">
                <span class="logo-icon">ğŸ‰</span>
                <span>CNSHç¼–è¾‘å™¨ v2.0</span>
            </div>
        </div>
        <div class="toolbar-buttons">
            <button class="btn btn-white" onclick="newFile()">
                ğŸ“„ æ–°å»º
            </button>
            <button class="btn btn-white" onclick="saveFile()">
                ğŸ’¾ ä¿å­˜
            </button>
            <button class="btn btn-gold" onclick="insertDNA()">
                ğŸ§¬ DNAè¿½æº¯
            </button>
            <button class="btn btn-green" onclick="compile()">
                â–¶ï¸ ç¼–è¯‘è¿è¡Œ
            </button>
        </div>
    </div>

    <!-- ä¸»å®¹å™¨ -->
    <div class="container">
        <!-- ä¾§è¾¹æ  -->
        <div class="sidebar">
            <div class="sidebar-header">ğŸ“š ä»£ç æ¨¡æ¿åº“</div>
            <div class="template-list">
                <div class="template-item" onclick="loadTemplate('hello')">
                    <div class="template-title">ğŸ‘‹ Hello World</div>
                    <div class="template-desc">æœ€ç®€å•çš„CNSHç¨‹åº</div>
                </div>
                <div class="template-item" onclick="loadTemplate('function')">
                    <div class="template-title">ğŸ”§ å‡½æ•°ç¤ºä¾‹</div>
                    <div class="template-desc">å‡½æ•°å®šä¹‰å’Œè°ƒç”¨</div>
                </div>
                <div class="template-item" onclick="loadTemplate('condition')">
                    <div class="template-title">ğŸ”€ æ¡ä»¶åˆ¤æ–­</div>
                    <div class="template-desc">if-elseè¯­å¥</div>
                </div>
                <div class="template-item" onclick="loadTemplate('loop')">
                    <div class="template-title">ğŸ”„ å¾ªç¯è¯­å¥</div>
                    <div class="template-desc">å¾ªç¯ã€Nã€‘è¯­æ³•</div>
                </div>
                <div class="template-item" onclick="loadTemplate('fibonacci')">
                    <div class="template-title">ğŸ”¢ æ–æ³¢é‚£å¥‘</div>
                    <div class="template-desc">é€’å½’å‡½æ•°ç¤ºä¾‹</div>
                </div>
                <div class="template-item" onclick="loadTemplate('calculator')">
                    <div class="template-title">ğŸ§® è®¡ç®—å™¨</div>
                    <div class="template-desc">å››åˆ™è¿ç®—</div>
                </div>
            </div>
        </div>

        <!-- ç¼–è¾‘å™¨åŒºåŸŸ -->
        <div class="editor-area">
            <div class="editor-tabs">
                <div class="editor-tab active">ğŸ“ main.cnsh</div>
            </div>
            <div class="code-mirror-wrapper">
                <textarea id="codeEditor"># ğŸ‡¨ğŸ‡³ CNSHä¸­æ–‡ç¼–ç¨‹è¯­è¨€
# DNAè¿½æº¯ç ï¼š#é¾™èŠ¯âš¡ï¸2026-02-02

å‡½æ•° ä¸»å‡½æ•°() è¿”å›ç±»å‹ æ•´æ•° {
  æ‰“å°ã€Œä½ å¥½ï¼ŒCNSHï¼ã€
  æ‰“å°ã€Œæ¬¢è¿ä½¿ç”¨ä¸­æ–‡ç¼–ç¨‹ã€
  è¿”å› 0
}</textarea>
            </div>
        </div>

        <!-- è¾“å‡ºåŒºåŸŸ -->
        <div class="output-area">
            <div class="output-tabs">
                <div class="output-tab active" onclick="switchOutput('console')">
                    ğŸ–¥ï¸ æ§åˆ¶å°
                </div>
                <div class="output-tab" onclick="switchOutput('ccode')">
                    âš™ï¸ Cä»£ç 
                </div>
            </div>
            <div id="consoleOutput" class="output-content active">
                <div class="log-info">â„¹ï¸ å‡†å¤‡å°±ç»ªï¼Œç‚¹å‡»"ç¼–è¯‘è¿è¡Œ"å¼€å§‹...</div>
            </div>
            <div id="ccodeOutput" class="output-content">
                <div class="c-code-display">// ç¼–è¯‘åçš„Cä»£ç å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...</div>
            </div>
        </div>
    </div>

    <!-- çŠ¶æ€æ  -->
    <div class="statusbar">
        <div class="status-item">
            <span class="status-indicator"></span>
            <span id="statusText">å°±ç»ª</span>
        </div>
        <div class="status-item">
            <span>è¡Œ: <span id="lineNum">1</span> | åˆ—: <span id="colNum">1</span></span>
        </div>
        <div class="status-item">
            <span>åˆ›å»ºè€…ï¼šğŸ’ é¾™èŠ¯åŒ—è¾° | UID9622</span>
        </div>
    </div>

    <script>
        // åˆå§‹åŒ–CodeMirror
        let editor = CodeMirror.fromTextArea(document.getElementById('codeEditor'), {
            mode: 'text/x-csrc',
            theme: 'dracula',
            lineNumbers: true,
            indentUnit: 4,
            tabSize: 4,
            lineWrapping: true,
            autofocus: true,
            extraKeys: {
                'Ctrl-Enter': compile,
                'Cmd-Enter': compile,
                'Ctrl-S': saveFile,
                'Cmd-S': saveFile
            }
        });

        // æ›´æ–°å…‰æ ‡ä½ç½®
        editor.on('cursorActivity', () => {
            const cursor = editor.getCursor();
            document.getElementById('lineNum').textContent = cursor.line + 1;
            document.getElementById('colNum').textContent = cursor.ch + 1;
        });

        // ä»£ç æ¨¡æ¿
        const TEMPLATES = {
            hello: `# ğŸ‡¨ğŸ‡³ Hello World
# DNAè¿½æº¯ç ï¼š#é¾™èŠ¯âš¡ï¸2026-02-02

å‡½æ•° ä¸»å‡½æ•°() è¿”å›ç±»å‹ æ•´æ•° {
  æ‰“å°ã€Œä½ å¥½ï¼ŒCNSHè¯­è¨€ï¼ã€
  æ‰“å°ã€Œæ¬¢è¿ä½¿ç”¨ä¸­æ–‡ç¼–ç¨‹ã€
  è¿”å› 0
}`,
            
            function: `# å‡½æ•°å®šä¹‰ç¤ºä¾‹
# DNAè¿½æº¯ç ï¼š#é¾™èŠ¯âš¡ï¸2026-02-02

å‡½æ•° è®¡ç®—å’Œ(æ•´æ•° ç”², æ•´æ•° ä¹™) è¿”å›ç±»å‹ æ•´æ•° {
  æ•´æ•° ç»“æœ = ç”² + ä¹™
  è¿”å› ç»“æœ
}

å‡½æ•° ä¸»å‡½æ•°() è¿”å›ç±»å‹ æ•´æ•° {
  æ•´æ•° å’Œ = è®¡ç®—å’Œ(10, 20)
  æ‰“å°ã€Œ10 + 20 = 30ã€
  è¿”å› 0
}`,
            
            condition: `# æ¡ä»¶åˆ¤æ–­ç¤ºä¾‹
# DNAè¿½æº¯ç ï¼š#é¾™èŠ¯âš¡ï¸2026-02-02

å‡½æ•° ä¸»å‡½æ•°() è¿”å›ç±»å‹ æ•´æ•° {
  æ•´æ•° åˆ†æ•° = 85
  
  å¦‚æœã€åˆ†æ•° >= 90ã€‘{
    æ‰“å°ã€Œä¼˜ç§€ã€
  } å¦åˆ™ {
    å¦‚æœã€åˆ†æ•° >= 60ã€‘{
      æ‰“å°ã€ŒåŠæ ¼ã€
    } å¦åˆ™ {
      æ‰“å°ã€Œä¸åŠæ ¼ã€
    }
  }
  
  è¿”å› 0
}`,
            
            loop: `# å¾ªç¯è¯­å¥ç¤ºä¾‹
# DNAè¿½æº¯ç ï¼š#é¾™èŠ¯âš¡ï¸2026-02-02

å‡½æ•° ä¸»å‡½æ•°() è¿”å›ç±»å‹ æ•´æ•° {
  æ‰“å°ã€Œå¼€å§‹å¾ªç¯ã€
  
  å¾ªç¯ã€10ã€‘{
    æ‰“å°ã€Œå¾ªç¯ä¸­...ã€
  }
  
  æ‰“å°ã€Œå¾ªç¯ç»“æŸã€
  è¿”å› 0
}`,
            
            fibonacci: `# æ–æ³¢é‚£å¥‘æ•°åˆ—
# DNAè¿½æº¯ç ï¼š#é¾™èŠ¯âš¡ï¸2026-02-02

å‡½æ•° æ–æ³¢é‚£å¥‘(æ•´æ•° æ•°) è¿”å›ç±»å‹ æ•´æ•° {
  å¦‚æœã€æ•° <= 1ã€‘{
    è¿”å› æ•°
  }
  
  æ•´æ•° å‰1 = æ–æ³¢é‚£å¥‘(æ•° - 1)
  æ•´æ•° å‰2 = æ–æ³¢é‚£å¥‘(æ•° - 2)
  
  è¿”å› å‰1 + å‰2
}

å‡½æ•° ä¸»å‡½æ•°() è¿”å›ç±»å‹ æ•´æ•° {
  æ•´æ•° ç»“æœ = æ–æ³¢é‚£å¥‘(10)
  æ‰“å°ã€Œæ–æ³¢é‚£å¥‘(10) = 55ã€
  è¿”å› 0
}`,
            
            calculator: `# ç®€å•è®¡ç®—å™¨
# DNAè¿½æº¯ç ï¼š#é¾™èŠ¯âš¡ï¸2026-02-02

å‡½æ•° ä¸»å‡½æ•°() è¿”å›ç±»å‹ æ•´æ•° {
  æ•´æ•° ç”² = 100
  æ•´æ•° ä¹™ = 25
  
  æ•´æ•° å’Œ = ç”² + ä¹™
  æ•´æ•° å·® = ç”² - ä¹™
  æ•´æ•° ç§¯ = ç”² * ä¹™
  æ•´æ•° å•† = ç”² / ä¹™
  
  æ‰“å°ã€Œ100 + 25 = 125ã€
  æ‰“å°ã€Œ100 - 25 = 75ã€
  æ‰“å°ã€Œ100 * 25 = 2500ã€
  æ‰“å°ã€Œ100 / 25 = 4ã€
  
  è¿”å› 0
}`
        };

        // åŠ è½½æ¨¡æ¿
        function loadTemplate(name) {
            editor.setValue(TEMPLATES[name] || TEMPLATES.hello);
            notify(`æ¨¡æ¿"${name}"å·²åŠ è½½`, 'success');
        }

        // æ–°å»ºæ–‡ä»¶
        function newFile() {
            if (confirm('ç¡®å®šè¦æ–°å»ºæ–‡ä»¶å—ï¼Ÿå½“å‰å†…å®¹å°†è¢«æ¸…ç©º')) {
                editor.setValue('');
                notify('æ–°æ–‡ä»¶å·²åˆ›å»º', 'success');
            }
        }

        // ä¿å­˜æ–‡ä»¶
        function saveFile() {
            const code = editor.getValue();
            const blob = new Blob([code], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'main.cnsh';
            a.click();
            URL.revokeObjectURL(url);
            notify('æ–‡ä»¶å·²ä¿å­˜', 'success');
        }

        // æ’å…¥DNAè¿½æº¯ç 
        function insertDNA() {
            const today = new Date().toISOString().split('T')[0];
            const dna = `# DNAè¿½æº¯ç ï¼š#é¾™èŠ¯âš¡ï¸${today}\n\n`;
            const cursor = editor.getCursor();
            editor.replaceRange(dna, {line: 0, ch: 0});
            notify('DNAè¿½æº¯ç å·²æ’å…¥', 'success');
        }

        // ç¼–è¯‘
        function compile() {
            const code = editor.getValue().trim();
            
            if (!code) {
                notify('è¯·å…ˆè¾“å…¥ä»£ç ', 'warning');
                return;
            }

            // æ¸…ç©ºè¾“å‡º
            document.getElementById('consoleOutput').innerHTML = '';
            document.getElementById('ccodeOutput').innerHTML = '';

            // æ·»åŠ ç¼–è¯‘æ—¥å¿—
            addLog('ğŸ›¡ï¸ é˜¶æ®µ0ï¼šä¸‰è‰²å®¡è®¡...', 'info');
            
            setTimeout(() => {
                addLog('ğŸŸ¢ ç»¿è‰² - å†…å®¹å®‰å…¨', 'success');
                addLog('ğŸ“ é˜¶æ®µ1ï¼šè¯æ³•åˆ†æ...', 'info');
                
                setTimeout(() => {
                    addLog('âœ… æ‰¾åˆ°token', 'success');
                    addLog('ğŸŒ³ é˜¶æ®µ2ï¼šè¯­æ³•åˆ†æ...', 'info');
                    
                    setTimeout(() => {
                        addLog('âœ… ç”ŸæˆAST', 'success');
                        addLog('âš™ï¸ é˜¶æ®µ3ï¼šä»£ç ç”Ÿæˆ...', 'info');
                        
                        setTimeout(() => {
                            // ç”ŸæˆCä»£ç 
                            const cCode = generateCCode(code);
                            document.getElementById('ccodeOutput').innerHTML = 
                                `<div class="c-code-display">${escapeHtml(cCode)}</div>`;
                            
                            addLog('âœ… ç¼–è¯‘æˆåŠŸï¼', 'success');
                            addLog('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”', 'info');
                            addLog('ğŸ–¥ï¸ è¿è¡Œç»“æœï¼š', 'info');
                            addLog('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”', 'info');
                            
                            // æ¨¡æ‹Ÿè¿è¡Œ
                            const output = simulateRun(cCode);
                            output.forEach(line => addLog(line, 'success'));
                            
                            addLog('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”', 'info');
                            addLog('âœ… ç¨‹åºæ‰§è¡Œå®Œæˆï¼ˆè¿”å›å€¼ï¼š0ï¼‰', 'success');
                            
                            notify('ç¼–è¯‘æˆåŠŸï¼', 'success');
                            document.getElementById('statusText').textContent = 'ç¼–è¯‘æˆåŠŸ';
                        }, 300);
                    }, 300);
                }, 300);
            }, 300);
        }

        // ç”ŸæˆCä»£ç ï¼ˆç®€åŒ–ç‰ˆï¼‰
        function generateCCode(cnshCode) {
            let c = `// Generated by CNSH Compiler v2.0
// DNAè¿½æº¯ç ï¼š#é¾™èŠ¯âš¡ï¸2026-02-02
// GPGæŒ‡çº¹ï¼šA2D0092CEE2E5BA87035600924C3704A8CC26D5F

#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>

`;
            
            c += cnshCode
                .replace(/å‡½æ•°\s+(\S+)\s*\([^)]*\)\s*è¿”å›ç±»å‹\s+æ•´æ•°/g, 'int $1()')
                .replace(/æ‰“å°ã€Œ([^ã€]*)ã€/g, 'printf("$1\\n");')
                .replace(/æ•´æ•°\s+(\S+)\s*=\s*(\d+)/g, 'int $1 = $2;')
                .replace(/å¦‚æœã€([^ã€‘]*)ã€‘/g, 'if ($1)')
                .replace(/å¦åˆ™/g, 'else')
                .replace(/å¾ªç¯ã€(\d+)ã€‘/g, 'for (int __i = 0; __i < $1; __i++)')
                .replace(/è¿”å›\s+(\d+)/g, 'return $1;')
                .replace(/#[^\n]*/g, '//');
            
            c += `\n\nint main() {\n    ä¸»å‡½æ•°();\n    return 0;\n}`;
            
            return c;
        }

        // æ¨¡æ‹Ÿè¿è¡Œ
        function simulateRun(cCode) {
            const lines = [];
            const regex = /printf\("([^"]+)\\n"\);/g;
            let match;
            
            while ((match = regex.exec(cCode)) !== null) {
                lines.push(match[1]);
            }
            
            return lines;
        }

        // æ·»åŠ æ—¥å¿—
        function addLog(text, type) {
            const log = document.createElement('div');
            log.className = `log-item log-${type}`;
            log.textContent = text;
            document.getElementById('consoleOutput').appendChild(log);
            document.getElementById('consoleOutput').scrollTop = 
                document.getElementById('consoleOutput').scrollHeight;
        }

        // åˆ‡æ¢è¾“å‡ºæ ‡ç­¾
        function switchOutput(tab) {
            document.querySelectorAll('.output-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.output-content').forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tab === 'console' ? 'consoleOutput' : 'ccodeOutput').classList.add('active');
        }

        // é€šçŸ¥
        function notify(message, type) {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideIn 0.3s reverse';
                setTimeout(() => document.body.removeChild(notification), 300);
            }, 3000);
        }

        // HTMLè½¬ä¹‰
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // åˆå§‹åŒ–
        notify('ğŸ‰ CNSHç¼–è¾‘å™¨ v2.0 å·²å¯åŠ¨', 'success');
    </script>
</body>
</html>
